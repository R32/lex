Lex Macro
------

Build State Transition Table in macro(compile phase) and the table format is:

|     NOTE     |  RAW DATA |
|:-------------|--------- |
| SEGMENT 1    | Each segment will correspond to a state |
| SEGMENT 2    |   |
| SEGMENT 3    |   |
| SEGMENT N    |   |
| ROLLBACK TO  | O(1) to rollback to the previous match if have(See below) |
| ROLLBACK LEN | stack length when rollback occurs |
| EXITS        | marked from which production(rhs) to exit |

so the table size is: `(segN + 2 + 1) * rowSize`.

there is a **special LR0** parser table generated by `-D lex_lr0table`. you can see how the rollback works.

```
Production:
  (R0)  E --> int + int * int
  (R1)    --> int + int
  (R2)    --> int
-------------------------------------------------
|  (S)  | (RB)  | (EP)  |  int  |   +   |   *   |
-------------------------------------------------
|   0   | NULL  | NULL  |   1   |       |       |
-------------------------------------------------
|   1   | NULL  |  R2   |       |   2   |       |
-------------------------------------------------
|   2   | R2+L1 | NULL  |   3   |       |       |
-------------------------------------------------
|   3   | R2+L2 |  R1   |       |       |   4   |
-------------------------------------------------
|   4   | R1+L1 | NULL  |  R0   |       |       |
-------------------------------------------------
```

## status

* [x] Lexer: Does not support unicode(The maximum char is 254)
* [ ] Parser: Not available yet

## Usage

...

### Defines

It looks very messy here.

* use `-D lex_switch` or the numble of rules is less then 6 then the function jump table will be converted as `switch` expr

* `-D lex_charmax`: to simply handle for utf16 char, Because the State Transition Table is 8-bit, If the input value is too large, there may be got out-of-range error.

  ```hx
  // source code from lm.LexBuilder
  var c = input.readByte(i++);
  #if lex_charmax
  if (c > CMAX) c = CMAX; // CMAX default value is 255.
  #end
  state = trans(state, c);
  ```
* `-D lex_rawtable or -D lex_strtable`: use `Bytes`(*No encoding specified*) or `String` as table format.

  By default, `String` format is used for **JS**, other platforms use `Bytes` format.

* `-D lex_rawinput`: then force use `Bytes` as the input format, default is `String`. see `lms.ByteData`

  actually you can use `--remap <package:target>` to override it.

* `-D lex_lr0table`: for debug. it will generate a LR0 table save as `lr0-table.txt`.